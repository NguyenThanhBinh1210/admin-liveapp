# PHÃ‚N TÃCH Dá»° ÃN ADMIN-LIVEAPP

## ğŸ“‹ Tá»”NG QUAN Dá»° ÃN

### ThÃ´ng tin cÆ¡ báº£n:
- **TÃªn dá»± Ã¡n**: admin-liveapp (Mantis Material Free React)
- **PhiÃªn báº£n**: 1.5.0
- **Framework**: React 19.1.0 + Vite 6.3.1
- **UI Library**: Material-UI (MUI) 7.0.2 + Ant Design 5.26.4
- **Routing**: React Router 7.5.1
- **State Management**: SWR 2.3.3
- **HTTP Client**: Axios 1.10.0
- **Authentication**: JWT vá»›i Cookies (js-cookie 3.0.5)

### Má»¥c Ä‘Ã­ch:
- á»¨ng dá»¥ng quáº£n trá»‹ (Admin Panel) cho há»‡ thá»‘ng livestream
- Quáº£n lÃ½ users, top-up requests, withdraw requests, gifts, config vÃ  thá»‘ng kÃª

## ğŸ”§ Cáº¤U HÃŒNH & API

### 1. **API Base URL** (Quan trá»ng):
```javascript
// File: src/api/config.js
const API_BASE_URL = 'https://apilive.loltips.net/api/v1';
```

### 2. **Cáº¥u hÃ¬nh á»©ng dá»¥ng**:
```javascript
// File: src/config.js
export const APP_DEFAULT_PATH = '/dashboard/default';
export const DRAWER_WIDTH = 260;
export const MINI_DRAWER_WIDTH = 60;
```

### 3. **Environment Variables**:
- `VITE_APP_BASE_NAME`: Base name cho routing
- Sá»­ dá»¥ng trong vite.config.mjs vÃ  routing

### 4. **Authentication System**:
- **Access Token**: LÆ°u trong cookie, expires 7 ngÃ y
- **Refresh Token**: LÆ°u trong cookie, expires 30 ngÃ y
- **Cookie Settings**: 
  - Path: '/'
  - SameSite: 'Lax'
  - Secure: false (development)

## ğŸ—ï¸ KIáº¾N TRÃšC Dá»° ÃN

### 1. **Cáº¥u trÃºc thÆ° má»¥c**:
```
src/
â”œâ”€â”€ api/                 # API calls
â”‚   â”œâ”€â”€ config.js       # Axios configuration & interceptors
â”‚   â”œâ”€â”€ auth.js         # Authentication APIs
â”‚   â”œâ”€â”€ user.js         # User management APIs
â”‚   â”œâ”€â”€ gift.js         # Gifts management APIs
â”‚   â”œâ”€â”€ wallet.js       # Wallet/Payment APIs
â”‚   â”œâ”€â”€ admin.js        # Admin functions APIs
â”‚   â”œâ”€â”€ menu.js         # Menu state management
â”‚   â””â”€â”€ index.js        # Central export point
â”œâ”€â”€ components/         # Reusable components
â”œâ”€â”€ hooks/              # Custom hooks
â”œâ”€â”€ layout/             # Layout components
â”œâ”€â”€ menu-items/         # Menu configuration
â”œâ”€â”€ pages/              # Page components
â”œâ”€â”€ routes/             # Routing configuration
â”œâ”€â”€ themes/             # Theme customization
â””â”€â”€ utils/              # Utility functions
```

### 2. **Routing Structure**:
- **Main Routes**: ÄÆ°á»£c báº£o vá»‡ bá»Ÿi ProtectedRoute
- **Login Routes**: KhÃ´ng cáº§n authentication
- **Protected Routes**: Kiá»ƒm tra JWT token trong cookies

### 3. **Menu System**:
```javascript
// CÃ¡c module chÃ­nh:
- Dashboard (default)
- Administration:
  - Users Management (/users)
  - Top-up Requests (/topup-requests)
  - Withdraw Requests (/withdraw-requests)
  - Gifts Management (/gifts)
  - System Config (/config)
  - Platform Statistics (/stats)
```

## ğŸ” AUTHENTICATION FLOW

### 1. **Login Process**:
1. User nháº­p email/password
2. Gá»i API: `POST /auth/login`
3. Nháº­n accessToken & refreshToken
4. LÆ°u tokens vÃ o cookies
5. Redirect Ä‘áº¿n dashboard

### 2. **Token Management**:
- **Axios Interceptor**: Tá»± Ä‘á»™ng thÃªm Bearer token vÃ o headers
- **Auto Refresh**: Khi token háº¿t háº¡n (401), tá»± Ä‘á»™ng refresh
- **Logout**: XÃ³a cookies vÃ  redirect vá» login

### 3. **Route Protection**:
```javascript
// ProtectedRoute component kiá»ƒm tra:
- isAuthenticated() tá»« cookies
- Redirect vá» /login náº¿u chÆ°a auth
- LÆ°u current path Ä‘á»ƒ redirect back
```

## ğŸ“Š CHá»¨C NÄ‚NG CHÃNH

### 1. **User Management**:
- **API**: `/admin/users`
- **Chá»©c nÄƒng**: Xem danh sÃ¡ch, cáº­p nháº­t role
- **Filters**: email, page, limit, role

### 2. **Top-up Requests**:
- **API**: `/admin/topup-requests`
- **Chá»©c nÄƒng**: Xem requests, approve/reject
- **Status**: pending, approved, rejected

### 3. **Withdraw Requests**:
- **API**: `/admin/withdraw-requests`
- **Chá»©c nÄƒng**: Xem requests, approve/reject
- **Status**: pending, approved, rejected

### 4. **Gifts Management**:
- **API**: `/admin/gifts`
- **CRUD**: Create, Read, Update gifts
- **Features**: Gift creation, editing

### 5. **System Config**:
- **API**: `/admin/config`
- **Chá»©c nÄƒng**: Xem vÃ  cáº­p nháº­t cáº¥u hÃ¬nh há»‡ thá»‘ng

### 6. **Statistics**:
- **API**: `/admin/stats`, `/admin/dashboard-stats`
- **Chá»©c nÄƒng**: Thá»‘ng kÃª platform vÃ  dashboard

## ğŸ› ï¸ CÃ”NG NGHá»† Sá»¬ Dá»¤NG

### Frontend Stack:
- **React 19.1.0**: Core framework
- **Vite 6.3.1**: Build tool
- **Material-UI 7.0.2**: Primary UI components
- **Ant Design 5.26.4**: Additional UI components
- **React Router 7.5.1**: Routing
- **SWR 2.3.3**: Data fetching & caching
- **Axios 1.10.0**: HTTP client
- **Formik 2.4.6**: Form handling
- **Yup 1.6.1**: Form validation
- **js-cookie 3.0.5**: Cookie management
- **Framer Motion 12.8.2**: Animations

### Development Tools:
- **ESLint 9.25.1**: Code linting
- **Prettier 3.5.3**: Code formatting
- **Knip 5.45.0**: Unused code detection

## ğŸ”„ STATE MANAGEMENT

### 1. **SWR cho API calls**:
- Cache & revalidation
- Loading states
- Error handling

### 2. **Menu State**:
```javascript
// src/api/menu.js
- isDashboardDrawerOpened: Boolean
- Sá»­ dá»¥ng SWR mutate Ä‘á»ƒ update state
```

### 3. **Authentication State**:
```javascript
// src/hooks/useAuth.js
- isAuth: Boolean
- token: String
- checkAuth(): Function
```

## ğŸ“ CODING STANDARDS

### 1. **Component Structure**:
- Functional components vá»›i hooks
- Lazy loading cho pages
- Loadable wrapper cho code splitting

### 2. **API Structure**:
- **Modular Design**: TÃ¡ch API theo chá»©c nÄƒng
- **Centralized Config**: Axios instance vÃ  interceptors trong `config.js`
- **Consistent Error Format**: Unified error handling
- **Easy Import**: Central export point tá»« `index.js`

### 3. **API Modules**:
- **config.js**: Base configuration, interceptors
- **auth.js**: Authentication (login, logout, profile)
- **user.js**: User management (CRUD users)
- **gift.js**: Gifts management (CRUD gifts)
- **wallet.js**: Wallet operations (topup, withdraw)
- **admin.js**: Admin functions (config, stats, logs)
- **menu.js**: Menu state management
- **index.js**: Central export point

### 4. **File Naming**:
- PascalCase cho components
- camelCase cho utilities
- kebab-case cho routes

## ğŸš€ BUILD & DEPLOYMENT

### Scripts:
```json
"start": "vite"                    # Development server
"build": "vite build"              # Production build
"build-stage": "env-cmd -f .env.qa vite build"  # Staging build
"preview": "vite preview"          # Preview build
```

### Build Configuration:
- **Port**: 3000
- **Base URL**: Tá»« environment variable
- **Auto-open**: Browser tá»± Ä‘á»™ng má»Ÿ
- **Host**: true (cho network access)

## ğŸ” ÄIá»‚M QUAN TRá»ŒNG Cáº¦N LÆ¯U Ã

### 1. **API Endpoint**:
- Base URL: `https://apilive.loltips.net/api/v1`
- CÃ³ thá»ƒ thay Ä‘á»•i trong `src/api/config.js`

### 2. **Authentication**:
- Sá»­ dá»¥ng cookies thay vÃ¬ localStorage
- Auto-refresh token mechanism
- Secure cookie settings cáº§n update cho production

### 3. **Error Handling**:
- Centralized error handling trong axios interceptors
- Consistent error format across app

### 4. **Performance**:
- Lazy loading cho pages
- SWR caching cho API calls
- Code splitting vá»›i Loadable

### 5. **Security**:
- CSRF protection vá»›i SameSite cookies
- JWT token validation
- Route protection

## ğŸ“‹ TODO & IMPROVEMENTS

### 1. **Security Enhancements**:
- Set secure: true cho production
- Add CSRF token validation
- Implement rate limiting

### 2. **Performance**:
- Add service worker
- Implement virtual scrolling cho large lists
- Optimize bundle size

### 3. **UX Improvements**:
- Add loading skeletons
- Implement offline support
- Add toast notifications

### 4. **Code Quality**:
- Add unit tests
- Implement TypeScript
- Add Storybook for components

---

**Cáº­p nháº­t láº§n cuá»‘i**: $(date)
**PhiÃªn báº£n phÃ¢n tÃ­ch**: 1.0.0 